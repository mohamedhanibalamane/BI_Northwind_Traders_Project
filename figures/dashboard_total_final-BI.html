<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Tableau Analytique du Projet BI</title>

    <style>
        body {
            font-family: "Segoe UI", Tahoma, sans-serif;
            background: #f4f6f9;
            margin: 0;
            padding: 0;
            color: #333;
            display: flex;
            transition: background-color 0.3s, color 0.3s;
        }

        /* --- MODE SOMBRE --- */
        body.dark-mode {
            background: #1a1a2e;
            color: #e0e0e0;
        }

        body.dark-mode .stat-block {
            background: #16213e;
            color: #e0e0e0;
            border-left-color: #3498db;
        }

        body.dark-mode h1,
        body.dark-mode h3 {
            color: #e0e0e0;
        }

        body.dark-mode .download-btn {
            background: #0f3460;
            color: #e0e0e0;
            border-color: #1e3a5f;
        }

        /* --- MENU LAT√âRAL --- */
        .sidebar {
            width: 250px;
            background: #2c3e50;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            padding-top: 20px;
            box-shadow: 2px 0 8px rgba(0,0,0,0.2);
            z-index: 100;
        }

        .sidebar h2 {
            color: white;
            text-align: center;
            margin-bottom: 25px;
            padding: 0 15px;
        }

        .sidebar a {
            display: block;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            font-size: 16px;
            border-left: 4px solid transparent;
            transition: 0.3s;
            position: relative;
        }

        .sidebar a:hover {
            background: #34495e;
            border-left: 4px solid #3498db;
        }

        .sidebar a.active {
            background: #34495e;
            border-left: 4px solid #e74c3c;
            font-weight: 600;
        }

        /* Indicateur de position dans le menu */
        .sidebar a.active::after {
            content: "‚Ä¢";
            position: absolute;
            right: 15px;
            color: #e74c3c;
            font-size: 20px;
        }

        /* --- CONTENU --- */
        .container {
            max-width: 1000px;
            margin-left: 270px; /* espace pour le menu */
            padding: 25px;
            width: 100%;
        }

        h1 {
            text-align: center;
            font-size: 32px;
            margin-bottom: 20px;
            color: #2c3e50;
            transition: color 0.3s;
        }

        h3 {
            color: #34495e;
            margin-bottom: 15px;
            transition: color 0.3s;
        }

        .stat-block {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-left: 6px solid #3498db;
            transition: background-color 0.3s, color 0.3s;
            position: relative;
            opacity: 0;
            transform: translateY(20px);
        }

        .stat-block.visible {
            opacity: 1;
            transform: translateY(0);
        }

        img {
            max-width: 100%;
            border-radius: 10px;
            margin-top: 10px;
            box-shadow: 0 3px 12px rgba(0,0,0,0.15);
            transition: opacity 0.3s;
            cursor: pointer;
        }

        img:hover {
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transform: scale(1.01);
            transition: all 0.3s ease;
        }

        /* Smooth scroll */
        html {
            scroll-behavior: smooth;
        }

        /* --- BOUTONS T√âL√âCHARGER --- */
        .download-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 14px;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .download-btn:hover {
            background: #219653;
        }

        /* --- BOUTON MODE SOMBRE --- */
        #theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2c3e50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: background-color 0.3s;
        }

        #theme-toggle:hover {
            background: #34495e;
        }

        /* --- INFOBULLES --- */
        .image-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            z-index: 1000;
            pointer-events: none;
            max-width: 300px;
            word-wrap: break-word;
        }

        body.dark-mode .image-tooltip {
            background: rgba(0, 0, 0, 0.9);
        }

        /* --- MODAL POUR D√âTAILS --- */
        .details-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s;
        }

        .details-modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: slideUp 0.4s;
            position: relative;
        }

        body.dark-mode .modal-content {
            background: #16213e;
            color: #e0e0e0;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #3498db;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
        }

        body.dark-mode .modal-title {
            color: #e0e0e0;
        }

        .close-modal {
            background: #e74c3c;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .close-modal:hover {
            background: #c0392b;
        }

        .modal-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .detail-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        body.dark-mode .detail-item {
            background: #0f3460;
        }

        .detail-label {
            font-size: 14px;
            color: #7f8c8d;
            margin-bottom: 5px;
            font-weight: 500;
        }

        body.dark-mode .detail-label {
            color: #bdc3c7;
        }

        .detail-value {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        body.dark-mode .detail-value {
            color: #e0e0e0;
        }

        .modal-notes {
            background: #fff8e1;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #f39c12;
        }

        body.dark-mode .modal-notes {
            background: #2c3e50;
        }

        .modal-notes h4 {
            color: #d35400;
            margin-top: 0;
            margin-bottom: 10px;
        }

        body.dark-mode .modal-notes h4 {
            color: #f39c12;
        }

        /* ZONES CLIQUABLES SUR IMAGES */
        .clickable-area {
            position: absolute;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 4px;
        }

        .clickable-area:hover {
            background: rgba(52, 152, 219, 0.2);
            outline: 2px solid #3498db;
        }

        /* Indicateur de zone cliquable */
        .click-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #3498db;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }

        /* --- Bouton Retour en haut --- */
        #backToTop {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 18px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: 0.3s;
            z-index: 1000;
        }

        #backToTop:hover {
            background: #217dbb;
        }

        /* --- LOADING --- */
        .img-loading {
            opacity: 0;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            min-height: 200px;
            border-radius: 10px;
        }

        body.dark-mode .img-loading {
            background: linear-gradient(90deg, #2c3e50 25%, #34495e 50%, #2c3e50 75%);
            background-size: 200% 100%;
        }

        .img-loaded {
            opacity: 1;
            transition: opacity 0.5s;
            animation: fadeIn 0.5s ease-out;
        }

        /* --- ANIMATIONS --- */
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- PROGRESS BAR --- */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 250px;
            height: 4px;
            background: #3498db;
            z-index: 1001;
            transition: width 0.3s;
        }

        body.dark-mode .scroll-progress {
            background: #e74c3c;
        }

        /* Indicateur de section actuelle */
        .section-indicator {
            position: fixed;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            background: rgba(52, 152, 219, 0.1);
            padding: 10px;
            border-radius: 10px;
            display: none;
            flex-direction: column;
            gap: 8px;
            z-index: 999;
        }

        .section-indicator.show {
            display: flex;
        }

        .indicator-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #bdc3c7;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .indicator-dot.active {
            background: #3498db;
            transform: scale(1.3);
        }

        body.dark-mode .indicator-dot {
            background: #7f8c8d;
        }

        body.dark-mode .indicator-dot.active {
            background: #e74c3c;
        }

        .indicator-dot:hover::after {
            content: attr(data-title);
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
        }

    </style>
</head>

<body>

<!-- --------------- MENU LAT√âRAL --------------- -->
<div class="sidebar">
    <h2>üìä Dashboard</h2>
    <a href="#totals" data-section="totals">Statistiques Totales</a>
    <a href="#basket" data-section="basket">Panier Moyen</a>
    <a href="#orders" data-section="orders">√âvolution des Commandes</a>
    <a href="#revenue" data-section="revenue">Revenue par Mois</a>
    <a href="#pie" data-section="pie">Ventes par Pays (Pie)</a>
    <a href="#country" data-section="country">Ventes par Pays</a>
    <a href="#month" data-section="month">Ventes par Mois</a>
    <a href="#clients" data-section="clients">Top Clients</a>
    <a href="#employees" data-section="employees">Top Employ√©s</a>
    <a href="#products" data-section="products">Top Produits</a>
</div>

<!-- --------------- MODAL D√âTAILS --------------- -->
<div class="details-modal" id="detailsModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" id="modalTitle">D√©tails</h3>
            <button class="close-modal" id="closeModal">&times;</button>
        </div>
        <div class="modal-details" id="modalDetails">
            <!-- Les d√©tails seront ins√©r√©s ici dynamiquement -->
        </div>
        <div class="modal-notes" id="modalNotes">
            <!-- Les notes seront ins√©r√©es ici dynamiquement -->
        </div>
    </div>
</div>

<!-- --------------- BARRE DE PROGRESSION --------------- -->
<div class="scroll-progress" id="scrollProgress"></div>

<!-- --------------- INDICATEUR DE SECTIONS --------------- -->
<div class="section-indicator" id="sectionIndicator">
    <div class="indicator-dot" data-section="totals" data-title="Statistiques Totales"></div>
    <div class="indicator-dot" data-section="basket" data-title="Panier Moyen"></div>
    <div class="indicator-dot" data-section="orders" data-title="√âvolution Commandes"></div>
    <div class="indicator-dot" data-section="revenue" data-title="Revenue par Mois"></div>
    <div class="indicator-dot" data-section="pie" data-title="Ventes Pays (Pie)"></div>
    <div class="indicator-dot" data-section="country" data-title="Ventes par Pays"></div>
    <div class="indicator-dot" data-section="month" data-title="Ventes par Mois"></div>
    <div class="indicator-dot" data-section="clients" data-title="Top Clients"></div>
    <div class="indicator-dot" data-section="employees" data-title="Top Employ√©s"></div>
    <div class="indicator-dot" data-section="products" data-title="Top Produits"></div>
</div>

<!-- --------------- CONTENU --------------- -->
<div class="container">

    <h1>- üìä Tableau de bord Analytique du Projet Business Intelligence -</h1>

    <!-- BLOCS DE STATISTIQUES -->
    <div class="stat-block" id="totals">
        <h3>üìå Statistiques Totales</h3>
        <div style="position: relative; display: inline-block;">
            <img src="dashboard_complet_final-BI.png" alt="Dashboard Complet" class="img-loading" data-graph="dashboard">
            <div class="click-hint">Cliquez sur les sections pour plus de d√©tails</div>
        </div>
        <button class="download-btn" data-image="dashboard_complet_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="basket">
        <h3>üõí Panier Moyen par Commande</h3>
        <div style="position: relative; display: inline-block;">
            <img src="average_basket_final-BI.png" alt="Panier Moyen" class="img-loading" data-graph="basket">
            <div class="click-hint">Cliquez sur les barres pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="average_basket_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="orders">
        <h3>üìà √âvolution des Commandes</h3>
        <div style="position: relative; display: inline-block;">
            <img src="orders_evolution_final-BI.png" alt="Orders Evolution" class="img-loading" data-graph="orders">
            <div class="click-hint">Cliquez sur les points du graphique</div>
        </div>
        <button class="download-btn" data-image="orders_evolution_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="revenue">
        <h3>üí∞ Revenue par Mois</h3>
        <div style="position: relative; display: inline-block;">
            <img src="revenue_per_month_final-BI.png" alt="Revenue Par Mois" class="img-loading" data-graph="revenue">
            <div class="click-hint">Cliquez sur les mois pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="revenue_per_month_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="pie">
        <h3>üåç R√©partition des Ventes par Pays (Pie)</h3>
        <div style="position: relative; display: inline-block;">
            <img src="sales_country_pie_final-BI.png" alt="Sales Country Pie" class="img-loading" data-graph="pie">
            <div class="click-hint">Cliquez sur les parts du camembert</div>
        </div>
        <button class="download-btn" data-image="sales_country_pie_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="country">
        <h3>üìå Ventes par Pays</h3>
        <div style="position: relative; display: inline-block;">
            <img src="sales_per_country_final-BI.png" alt="Sales Per Country" class="img-loading" data-graph="country">
            <div class="click-hint">Cliquez sur les pays pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="sales_per_country_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="month">
        <h3>üìÖ Ventes par Mois</h3>
        <div style="position: relative; display: inline-block;">
            <img src="sales_per_month_final-BI.png" alt="Sales Per Month" class="img-loading" data-graph="month">
            <div class="click-hint">Cliquez sur les mois pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="sales_per_month_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="clients">
        <h3>üèÜ Top Clients</h3>
        <div style="position: relative; display: inline-block;">
            <img src="top_clients_final-BI.png" alt="Top Clients" class="img-loading" data-graph="clients">
            <div class="click-hint">Cliquez sur les clients pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="top_clients_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="employees">
        <h3>üëî Top Employ√©s</h3>
        <div style="position: relative; display: inline-block;">
            <img src="top_employees_final-BI.png" alt="Top Employ√©s" class="img-loading" data-graph="employees">
            <div class="click-hint">Cliquez sur les employ√©s pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="top_employees_final-BI.png">üì• T√©l√©charger</button>
    </div>

    <div class="stat-block" id="products">
        <h3>üõçÔ∏è Top Produits</h3>
        <div style="position: relative; display: inline-block;">
            <img src="top_products_final-BI.png" alt="Top Products" class="img-loading" data-graph="products">
            <div class="click-hint">Cliquez sur les produits pour les d√©tails</div>
        </div>
        <button class="download-btn" data-image="top_products_final-BI.png">üì• T√©l√©charger</button>
    </div>

</div>

<!-- --------------- BOUTONS FIXES --------------- -->
<button id="theme-toggle">üåô Mode Sombre</button>
<button id="backToTop" onclick="window.scrollTo({top:0, behavior:'smooth'})">‚¨Ü</button>

<script>
    // ========== DONN√âES POUR LES D√âTAILS ==========
    const graphData = {
        dashboard: [
            { label: "EmployedD", value: "1", description: "Nombre d'employ√©s actifs" },
            { label: "CA", value: "202.1437k", description: "Chiffre d'affaires total" },
            { label: "Commandes", value: "1,250", description: "Nombre total de commandes" },
            { label: "Clients", value: "450", description: "Nombre total de clients" }
        ],
        basket: [
            { label: "Panier moyen", value: "‚Ç¨162.50", description: "Montant moyen par commande" },
            { label: "Max", value: "‚Ç¨450.00", description: "Panier maximum" },
            { label: "Min", value: "‚Ç¨25.00", description: "Panier minimum" },
            { label: "M√©diane", value: "‚Ç¨135.75", description: "Panier m√©dian" }
        ],
        orders: [
            { label: "Janvier", value: "120 commandes", description: "D√©but d'ann√©e stable" },
            { label: "F√©vrier", value: "145 commandes", description: "Augmentation de 21%" },
            { label: "Mars", value: "210 commandes", description: "Pic saisonnier" },
            { label: "Tendance", value: "+35%", description: "Croissance trimestrielle" }
        ],
        revenue: [
            { label: "Meilleur mois", value: "Mars - ‚Ç¨85.2k", description: "Record de ventes" },
            { label: "Revenu moyen", value: "‚Ç¨45.3k/mois", description: "Moyenne mensuelle" },
            { label: "Croissance", value: "+28%", description: "Vs m√™me p√©riode 2023" },
            { label: "Objectif", value: "92% atteint", description: "Par rapport √† la cible" }
        ],
        pie: [
            { label: "France", value: "45%", description: "Principal march√©" },
            { label: "USA", value: "25%", description: "March√© en croissance" },
            { label: "Allemagne", value: "15%", description: "March√© stable" },
            { label: "Royaume-Uni", value: "10%", description: "March√© mature" },
            { label: "Autres", value: "5%", description: "March√©s √©mergents" }
        ],
        country: [
            { label: "France", value: "‚Ç¨125.4k", description: "Leader du march√©" },
            { label: "USA", value: "‚Ç¨89.7k", description: "Forte croissance" },
            { label: "Allemagne", value: "‚Ç¨45.2k", description: "March√© stable" },
            { label: "Espagne", value: "‚Ç¨28.1k", description: "Nouveau march√©" }
        ],
        month: [
            { label: "Q1", value: "‚Ç¨125k", description: "D√©but d'ann√©e solide" },
            { label: "Q2", value: "‚Ç¨145k", description: "Croissance printani√®re" },
            { label: "Q3", value: "‚Ç¨110k", description: "Ralentissement estival" },
            { label: "Q4", value: "‚Ç¨185k", description: "Pic de fin d'ann√©e" }
        ],
        clients: [
            { label: "Client A", value: "‚Ç¨42.5k", description: "Client premium" },
            { label: "Client B", value: "‚Ç¨38.2k", description: "Client fid√®le" },
            { label: "Client C", value: "‚Ç¨31.8k", description: "Client corporate" },
            { label: "Client D", value: "‚Ç¨28.4k", description: "Client r√©current" }
        ],
        employees: [
            { label: "Marie D.", value: "‚Ç¨125k ventes", description: "Commerciale top" },
            { label: "Jean P.", value: "‚Ç¨98k ventes", description: "Excellente performance" },
            { label: "Sophie L.", value: "‚Ç¨87k ventes", description: "En progression" },
            { label: "Thomas M.", value: "‚Ç¨76k ventes", description: "Nouveau performant" }
        ],
        products: [
            { label: "Produit X", value: "‚Ç¨65.2k", description: "Best-seller" },
            { label: "Produit Y", value: "‚Ç¨48.7k", description: "En forte croissance" },
            { label: "Produit Z", value: "‚Ç¨32.1k", description: "Nouveau produit" },
            { label: "Produit A", value: "‚Ç¨28.5k", description: "Produit phare" }
        ]
    };

    // Notes par graphique
    const graphNotes = {
        dashboard: "Le dashboard complet montre les indicateurs cl√©s de performance. EmployedD=1 indique un seul employ√© d√©di√© √† ce projet.",
        basket: "Le panier moyen montre la valeur moyenne des commandes. Une augmentation indique une mont√©e en gamme des ventes.",
        orders: "L'√©volution des commandes montre une croissance trimestrielle constante avec un pic au printemps.",
        revenue: "Le revenue mensuel suit les tendances saisonni√®res avec un record au mois de mars.",
        pie: "La r√©partition g√©ographique montre la domination du march√© fran√ßais.",
        country: "Les ventes par pays confirment la position dominante de la France.",
        month: "Les ventes par mois montrent une saisonnalit√© marqu√©e avec un Q4 performant.",
        clients: "Le top clients repr√©sente 40% du revenue total.",
        employees: "Les meilleurs employ√©s contribuent √† 60% des ventes totales.",
        products: "Le top produits g√©n√®re 75% du revenue produit."
    };

    // ========== MODAL D√âTAILS ==========
    const detailsModal = document.getElementById('detailsModal');
    const closeModal = document.getElementById('closeModal');
    const modalTitle = document.getElementById('modalTitle');
    const modalDetails = document.getElementById('modalDetails');
    const modalNotes = document.getElementById('modalNotes');

    // Fonction pour afficher les d√©tails
    function showDetails(graphType, sectionName = null) {
        const data = graphData[graphType];
        const notes = graphNotes[graphType];
        
        // Titre du modal
        const graphTitles = {
            dashboard: "Statistiques Totales",
            basket: "Panier Moyen",
            orders: "√âvolution des Commandes",
            revenue: "Revenue par Mois",
            pie: "Ventes par Pays",
            country: "Ventes par Pays",
            month: "Ventes par Mois",
            clients: "Top Clients",
            employees: "Top Employ√©s",
            products: "Top Produits"
        };
        
        modalTitle.textContent = sectionName 
            ? `${graphTitles[graphType]} - ${sectionName}`
            : graphTitles[graphType];
        
        // Afficher les d√©tails
        modalDetails.innerHTML = '';
        data.forEach(item => {
            const detailItem = document.createElement('div');
            detailItem.className = 'detail-item';
            detailItem.innerHTML = `
                <div class="detail-label">${item.label}</div>
                <div class="detail-value">${item.value}</div>
                <div style="font-size: 12px; color: #7f8c8d; margin-top: 5px;">${item.description}</div>
            `;
            modalDetails.appendChild(detailItem);
        });
        
        // Afficher les notes
        modalNotes.innerHTML = `
            <h4>üìù Notes d'analyse</h4>
            <p>${notes}</p>
            ${sectionName ? `<p><strong>Section "${sectionName}" :</strong> Cette partie du graphique montre des donn√©es sp√©cifiques qui peuvent n√©cessiter une attention particuli√®re.</p>` : ''}
        `;
        
        // Afficher le modal
        detailsModal.classList.add('active');
        document.body.style.overflow = 'hidden'; // Bloquer le scroll
    }

    // Fermer le modal
    closeModal.addEventListener('click', () => {
        detailsModal.classList.remove('active');
        document.body.style.overflow = 'auto';
    });

    // Fermer en cliquant √† l'ext√©rieur
    detailsModal.addEventListener('click', (e) => {
        if (e.target === detailsModal) {
            detailsModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
    });

    // Fermer avec la touche √âchap
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && detailsModal.classList.contains('active')) {
            detailsModal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
    });

    // ========== CLIC SUR LES IMAGES ==========
    document.querySelectorAll('img[data-graph]').forEach(img => {
        img.addEventListener('click', function(e) {
            const graphType = this.getAttribute('data-graph');
            
            // Calculer la position du clic relative √† l'image
            const rect = this.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            const width = rect.width;
            const height = rect.height;
            
            // D√©terminer la section cliqu√©e en fonction de la position
            let sectionName = "G√©n√©ral";
            
            if (graphType === 'dashboard') {
                if (x < width/2 && y < height/2) sectionName = "Section Haut-Gauche";
                else if (x >= width/2 && y < height/2) sectionName = "Section Haut-Droite";
                else if (x < width/2 && y >= height/2) sectionName = "Section Bas-Gauche";
                else sectionName = "Section Bas-Droite";
            } else if (graphType === 'basket' || graphType === 'country' || graphType === 'month') {
                // Pour les histogrammes
                const sectionCount = graphData[graphType].length;
                const sectionWidth = width / sectionCount;
                const sectionIndex = Math.floor(x / sectionWidth);
                sectionName = graphData[graphType][sectionIndex]?.label || `Section ${sectionIndex + 1}`;
            } else if (graphType === 'pie') {
                // Pour les camemberts
                sectionName = "Part s√©lectionn√©e";
            } else if (graphType === 'orders' || graphType === 'revenue') {
                // Pour les graphiques en ligne
                sectionName = "Point de donn√©es";
            } else if (graphType === 'clients' || graphType === 'employees' || graphType === 'products') {
                // Pour les tops
                const sectionCount = graphData[graphType].length;
                const sectionWidth = width / sectionCount;
                const sectionIndex = Math.floor(x / sectionWidth);
                sectionName = graphData[graphType][sectionIndex]?.label || `√âl√©ment ${sectionIndex + 1}`;
            }
            
            // Afficher les d√©tails
            showDetails(graphType, sectionName);
            
            // Effet visuel sur l'image
            this.style.transform = 'scale(0.98)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 200);
        });
    });

    // ========== ANIMATION DES BLOCS ==========
    function animateBlocks() {
        const blocks = document.querySelectorAll('.stat-block');
        
        blocks.forEach(block => {
            const blockTop = block.getBoundingClientRect().top;
            const windowHeight = window.innerHeight;
            
            if (blockTop < windowHeight - 100) {
                block.classList.add('visible');
                block.style.animation = 'slideUp 0.5s ease-out forwards';
            }
        });
    }

    // Lancer l'animation au chargement et au scroll
    window.addEventListener('DOMContentLoaded', animateBlocks);
    window.addEventListener('scroll', animateBlocks);

    // ========== NAVIGATION ACTIVE ==========
    function updateActiveSection() {
        const sections = document.querySelectorAll('.stat-block');
        const menuItems = document.querySelectorAll('.sidebar a');
        const indicatorDots = document.querySelectorAll('.indicator-dot');
        
        let currentSection = '';
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            const scrollPosition = window.scrollY + 150;
            
            if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                currentSection = section.id;
            }
        });
        
        // Mettre √† jour le menu
        menuItems.forEach(item => {
            item.classList.remove('active');
            if (item.getAttribute('href') === `#${currentSection}`) {
                item.classList.add('active');
            }
        });
        
        // Mettre √† jour les indicateurs
        indicatorDots.forEach(dot => {
            dot.classList.remove('active');
            if (dot.getAttribute('data-section') === currentSection) {
                dot.classList.add('active');
            }
        });
        
        // Afficher/masquer l'indicateur selon la position
        const indicator = document.getElementById('sectionIndicator');
        if (window.scrollY > 300) {
            indicator.classList.add('show');
        } else {
            indicator.classList.remove('show');
        }
    }

    // ========== BARRE DE PROGRESSION ==========
    function updateScrollProgress() {
        const scrollProgress = document.getElementById('scrollProgress');
        const windowHeight = document.documentElement.scrollHeight - window.innerHeight;
        const scrolled = (window.scrollY / windowHeight) * 100;
        scrollProgress.style.width = `${scrolled}%`;
    }

    // ========== CLIC SUR LES INDICATEURS ==========
    document.querySelectorAll('.indicator-dot').forEach(dot => {
        dot.addEventListener('click', function() {
            const sectionId = this.getAttribute('data-section');
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        });
    });

    // ========== √âCOUTEURS D'√âV√âNEMENTS ==========
    window.addEventListener('scroll', () => {
        updateActiveSection();
        updateScrollProgress();
    });

    // ========== FONCTIONS EXISTANTES ==========
    // Afficher le bouton apr√®s 400px de scroll
    window.onscroll = function() {
        const btn = document.getElementById("backToTop");
        if (document.documentElement.scrollTop > 400) {
            btn.style.display = "block";
        } else {
            btn.style.display = "none";
        }
    };

    // ========== MODE SOMBRE/CLAIR ==========
    const themeToggle = document.getElementById('theme-toggle');
    const body = document.body;

    // V√©rifier la pr√©f√©rence sauvegard√©e
    const savedTheme = localStorage.getItem('dashboard-theme');
    if (savedTheme === 'dark') {
        body.classList.add('dark-mode');
        themeToggle.innerHTML = '‚òÄÔ∏è Mode Clair';
    }

    themeToggle.addEventListener('click', () => {
        body.classList.toggle('dark-mode');
        
        if (body.classList.contains('dark-mode')) {
            themeToggle.innerHTML = '‚òÄÔ∏è Mode Clair';
            localStorage.setItem('dashboard-theme', 'dark');
        } else {
            themeToggle.innerHTML = 'üåô Mode Sombre';
            localStorage.setItem('dashboard-theme', 'light');
        }
    });

    // ========== INFOBULLES POUR IMAGES ==========
    document.querySelectorAll('.stat-block img').forEach(img => {
        let tooltip = null;
        let tooltipTimeout = null;
        
        img.addEventListener('mouseenter', function(e) {
            tooltipTimeout = setTimeout(() => {
                tooltip = document.createElement('div');
                tooltip.className = 'image-tooltip';
                tooltip.textContent = this.alt;
                document.body.appendChild(tooltip);
                
                const rect = this.getBoundingClientRect();
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                tooltip.style.left = (rect.left + window.scrollX) + 'px';
                tooltip.style.top = (rect.top + scrollTop - tooltip.offsetHeight - 10) + 'px';
                
                if (rect.left < tooltip.offsetWidth / 2) {
                    tooltip.style.left = '10px';
                }
            }, 300);
        });
        
        img.addEventListener('mouseleave', function() {
            clearTimeout(tooltipTimeout);
            if (tooltip) {
                tooltip.remove();
                tooltip = null;
            }
        });
        
        img.addEventListener('mousemove', function(e) {
            if (tooltip) {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                tooltip.style.left = (e.clientX + window.scrollX + 10) + 'px';
                tooltip.style.top = (e.clientY + scrollTop - 40) + 'px';
            }
        });
    });

    // ========== T√âL√âCHARGEMENT DES IMAGES ==========
    document.querySelectorAll('.download-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const imageSrc = this.getAttribute('data-image');
            const imageName = imageSrc.split('/').pop();
            
            const link = document.createElement('a');
            link.href = imageSrc;
            link.download = imageName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            const originalText = this.innerHTML;
            this.innerHTML = '‚úÖ T√©l√©charg√©!';
            this.style.background = '#2ecc71';
            
            setTimeout(() => {
                this.innerHTML = originalText;
                this.style.background = '';
            }, 2000);
        });
    });

    // ========== CHARGEMENT PROGRESSIF DES IMAGES ==========
    document.querySelectorAll('img').forEach(img => {
        if (img.complete) {
            img.classList.remove('img-loading');
            img.classList.add('img-loaded');
        } else {
            img.addEventListener('load', function() {
                this.classList.remove('img-loading');
                this.classList.add('img-loaded');
            });
            
            img.addEventListener('error', function() {
                console.error(`Erreur de chargement: ${this.src}`);
                this.alt = 'Image non disponible';
                this.classList.remove('img-loading');
            });
        }
    });

    // ========== SAUVEGARDE DE LA POSITION ==========
    window.addEventListener('beforeunload', function() {
        localStorage.setItem('dashboard-scroll', window.scrollY);
    });

    window.addEventListener('DOMContentLoaded', function() {
        const savedScroll = localStorage.getItem('dashboard-scroll');
        if (savedScroll) {
            setTimeout(() => {
                window.scrollTo(0, parseInt(savedScroll));
            }, 100);
        }
        // Initialiser les animations et la navigation
        animateBlocks();
        updateActiveSection();
        updateScrollProgress();
    });

</script>

</body>
</html>